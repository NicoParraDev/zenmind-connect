<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZenMindConnect 2.0 | Editar Perfil</title>
    <meta name="description" content="Edita tu perfil en ZenMindConnect">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS ZenMind 2.0 -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'CSS/zenmind_2.0_base.css' %}">
    <link rel="stylesheet" href="{% static 'CSS/zenmind_2.0_navbar.css' %}">
    <link rel="stylesheet" href="{% static 'CSS/zenmind_2.0_forms.css' %}">
    <link rel="stylesheet" href="{% static 'CSS/style_notificaciones.css' %}">
    
    <link rel="icon" href="{% static 'IMG/logo_final.png' %}">
</head>
<body>
    <!-- Navbar Moderno -->
    {% include 'core/navbar.html' %}

    <!-- Form Page -->
    <div class="form-page-container">
        <div class="form-wrapper">
            <div class="form-card">
                <div class="form-logo">
                    <img src="{% static 'IMG/logo_final.png' %}" alt="ZenMindConnect">
                </div>
                
                <div class="form-header">
                    <h1><i class="fas fa-user-edit"></i> Editar Perfil</h1>
                    <p>Actualiza tu información personal</p>
                </div>

                {% if messages %}
                <div style="margin-bottom: var(--spacing-lg);">
                    {% for message in messages %}
                    <div class="form-error">
                        <i class="fas fa-exclamation-circle"></i>
                        <span>{{ message }}</span>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}

                <form method="POST" action="#" id="formulario">
                    {% csrf_token %}
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.rut.id_for_label }}" class="form-label">
                                <i class="fas fa-id-card"></i> RUT
                            </label>
                            {{ form.rut }}
                            {% if form.rut.errors %}
                            <div class="form-error">{{ form.rut.errors }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label for="{{ form.nombre.id_for_label }}" class="form-label">
                                <i class="fas fa-user"></i> Nombre
                            </label>
                            {{ form.nombre }}
                            {% if form.nombre.errors %}
                            <div class="form-error">{{ form.nombre.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.apellido.id_for_label }}" class="form-label">
                                <i class="fas fa-user"></i> Apellido
                            </label>
                            {{ form.apellido }}
                            {% if form.apellido.errors %}
                            <div class="form-error">{{ form.apellido.errors }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label for="{{ form.fechaNac.id_for_label }}" class="form-label">
                                <i class="fas fa-birthday-cake"></i> Fecha de Nacimiento
                            </label>
                            {{ form.fechaNac }}
                            {% if form.fechaNac.errors %}
                            <div class="form-error">{{ form.fechaNac.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="{{ form.correo.id_for_label }}" class="form-label">
                                <i class="fas fa-envelope"></i> Correo Electrónico
                            </label>
                            {{ form.correo }}
                            {% if form.correo.errors %}
                            <div class="form-error">{{ form.correo.errors }}</div>
                            {% endif %}
                        </div>
                        
                        <div class="form-group">
                            <label for="{{ form.telefono.id_for_label }}" class="form-label">
                                <i class="fas fa-phone"></i> Teléfono
                            </label>
                            {{ form.telefono }}
                            {% if form.telefono.errors %}
                            <div class="form-error">{{ form.telefono.errors }}</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div style="margin-top: var(--spacing-lg); padding: var(--spacing-md); background: var(--bg-secondary); border-radius: var(--radius-md);">
                        <a href="{% url 'changepassword_login' %}" class="btn btn-primary">
                            <i class="fas fa-key"></i> Cambiar Contraseña
                        </a>
                    </div>
                    
                    <div style="display: flex; gap: var(--spacing-md); margin-top: var(--spacing-lg); flex-wrap: wrap;">
                        <button type="submit" class="btn btn-primary btn-lg" style="flex: 1; min-width: 200px;">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                        <button type="reset" class="btn btn-outline btn-lg" style="flex: 1; min-width: 200px;">
                            <i class="fas fa-redo"></i> Limpiar
                        </button>
                        <a href="{% url 'index' %}" class="btn btn-outline btn-lg" style="flex: 1; min-width: 200px;">
                            <i class="fas fa-arrow-left"></i> Volver
                        </a>
                    </div>
                </form>
                
                <div style="margin-top: var(--spacing-xl); padding-top: var(--spacing-lg); border-top: 2px solid var(--error);">
                    <p style="color: var(--text-secondary); margin-bottom: var(--spacing-md);">
                        <i class="fas fa-exclamation-triangle"></i> Zona de peligro
                    </p>
                    <button type="button" class="btn btn-outline" 
                            style="border-color: var(--error); color: var(--error); width: 100%;"
                            onclick="confirmarEliminarCuenta()">
                        <i class="fas fa-trash"></i> Eliminar Cuenta
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        function toggleMobileMenu() {
            const nav = document.getElementById('navbarNav');
            nav.classList.toggle('active');
        }
        
        function confirmarEliminarCuenta() {
            Swal.fire({
                title: '¿Estás seguro?',
                text: 'Esta acción no se puede deshacer. Todos tus posts, consultas y actividad se eliminarán permanentemente.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Sí, eliminar mi cuenta',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.isConfirmed) {
                    window.location.href = "{% url 'eliminar_cuenta_usuario' %}";
                }
            });
        }
    </script>
    
    {% if messages %}
        {% for m in messages %}
        <script>
            Swal.fire({
                text: "{{m}}",
                confirmButtonText: 'Vale',
                confirmButtonColor: '#4A90E2',
                backdrop: true,
                timer: 10000,
                timerProgressBar: true,
            })
        </script>
        {% endfor %}
    {% endif %}
</body>
</html>
